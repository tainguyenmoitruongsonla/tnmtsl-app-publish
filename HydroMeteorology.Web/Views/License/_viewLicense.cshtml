@using WaterResource.Service;
@{
    UserRightService _service = new UserRightService();
}
<div id="viewLicense" class="sidenav p-0 font-13">
    <div>
        <div class="doc-title py-2 px-0 col-12 d-flex align-items-center" style="background:#15538f; color: #fff; height: 50px">
            <div class="d-flex col-12 p-0 align-items-center">
                <div class="col-10">
                    <div class="admission-title d-flex center-center">
                        <p class="m-0 col-12 p-0 text-left text-uppercase font-16" ng-bind-html="asideHeader"></p>
                    </div>
                </div>
                <a href="javascript:void(0)" class="closebtn m-0 p-0 text-white" ng-click="closeAside('viewLicense')">&times;</a>
            </div>
        </div>
    </div>

    <div class="col-12">
        <fieldset class="col-12 border border-secondary px-2 mb-2 background-color bg-lightgray">
            <legend class="font-18 font-weight-bold text-primary" style="width: auto">THÔNG TIN TỔ CHỨC/CÁ NHÂN </legend>
            <div class="mb-2">
                <div class="col-sm-12 p-0 py-3 row m-0">
                    <div class="col-12 col-md-6">
                        <label class="font-13">Tên tổ chức/cá nhân được CP </label>
                        <input readonly class="floating-input w-100 text-left" type="text" placeholder=" " ng-model="license.Business.Name" />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Địa chỉ tổ chức/cá nhân được CP</label>
                        <input readonly class="floating-input w-100" ng-model="license.Business.Address" type="text" placeholder=" " />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Số giấy đăng ký kinh doanh </label>
                        <input readonly class="floating-input w-100 text-left" type="text" placeholder=" " ng-model="license.Business.IdentifierCode" />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Số điện thoại </label>
                        <input readonly class="floating-input w-100 text-left" type="text" placeholder=" " ng-model="license.Bussines.Phone" />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Email</label>
                        <input readonly class="floating-input w-100" ng-model="license.Bussines.Email" type="text" placeholder=" " />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Số Fax </label>
                        <input readonly class="floating-input w-100 text-left" type="text" placeholder=" " ng-model="license.Bussines.Fax" />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Người đại diện pháp luật</label>
                        <input readonly class="floating-input w-100" ng-model="license.Bussines.LegalRepresentative" type="text" placeholder=" " />
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="font-13">Người được ủy quyền</label>
                        <input readonly class="floating-input w-100" ng-model="license.Bussines.AuthorityPerson" type="text" placeholder=" " />
                    </div>
                </div>
            </div>
        </fieldset>
    </div>

    <div class="col-12">
        <fieldset class="col-12 border border-secondary p-2 mb-2 background-color bg-lightgray">
            <legend class="font-18 font-weight-bold text-primary" style="width: auto">THÔNG TIN GIẤY PHÉP</legend>
            <div class="mb-2">
                <div class="col-sm-12 p-0 py-3 table-responsive">
                    <div class="col-sm-12 p-0 row">
                        <div class="table table-sm col-12 col-md-6 m-0">
                            <div class="align-middle text-nowrap col-12 py-2">
                                <label>Số giấy phép<sup class="text-danger font-13">*</sup></label>
                                <input readonly class="floating-input w-100" ng-model="license.LicenseNumber" type="text" placeholder="Số giấy phép" />
                            </div>
                            <div class="align-middle text-nowrap col-12 py-2">
                                <label>Tên văn bản<sup class="text-danger font-13">*</sup></label>
                                <input readonly class="floating-input w-100" ng-model="license.LicenseName" type="text" placeholder="Tên văn bản" />
                            </div>
                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Loại hình giấy phép</label>
                                <input readonly class="floating-input w-100" ng-model="license.LicenseTypeName" type="text" placeholder=" " />
                            </div>
                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Cơ quan cấp phép</label>
                                <input readonly class="floating-input w-100" ng-model="license.LicensingAuthoritiesName" type="text" placeholder=" " />
                            </div>
                        </div>
                        <div class="table table-sm col-12 col-md-6 m-0">
                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Ngày ký</label>
                                <input readonly class="floating-input w-100" type="text" placeholder=" " ng-model="license.SignDate" />
                            </div>

                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Ngày có hiệu lực</label>
                                <input readonly class="floating-input w-100" type="text" placeholder=" " ng-model="license.IssueDate" />
                            </div>

                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Thời hạn giấy phép</label>
                                <input readonly class="floating-input w-100" type="text" placeholder=" " ng-model="license.Duration" />
                            </div>

                            <div class="align-middle text-nowrap col-12 py-2">
                                <label class="font-13">Ngày hết hiệu lực</label>
                                <input readonly class="floating-input w-100" type="text" placeholder=" " ng-model="license.ExpireDate" />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 p-0 row" ng-show="checkAddOldLicense">
                        <div class="col-12 col-md-6 py-2">
                            <label class="font-13">Số giấy phép cũ<sup class="text-danger font-13">*</sup> </label>
                            <div class="dropdown dropdown-scroll">
                                <input readonly class="floating-input w-100 text-left" type="text" data-toggle="dropdown" placeholder=" " ng-model="license.OldLicense.LicenseNumber" />
                                <ul class="dropdown-menu w-100 px-2" role="menu">
                                    <li class="border-bottom border-secondary p-0" ng-repeat='item in AllLicenses | filter:license.OldLicense.LicenseNumber'>
                                        <a href="javascript:void(0)" class="m-1 nav-link font-weight-normal py-0 px-1" ng-click="SetOldLicense(item)">
                                            <p class="m-0 text-primary" style="font-size: 0.85rem">{{item.LicenseNumber}}</p>
                                            <p class="m-0 text-muted" style="font-size: 0.75rem">{{item.SignDate}}</p>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 py-2">
                            <label class="font-13">Ngày ký giấy phép cũ<sup class="text-danger font-13">*</sup></label>
                            <input readonly class="floating-input w-100" ng-model="license.OldLicense.SignDate" type="text" placeholder="Ngày ký giấy phép cũ" />
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="col-12">
        <fieldset class="col-12 border border-secondary p-2 mb-2 background-color bg-lightgray">
            <legend class="font-18 font-weight-bold text-primary" style="width: auto">THÔNG TIN TRẠM QUAN TRẮC KTTV</legend>
            <div class="row col-12 m-0">
                <div class="col-md-6 py-2">
                    <label> Tên trạm </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.Name">
                </div>
                <div class="col-md-3 py-2">
                    <label> Mã trạm </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.StationCode">
                </div>
                <div class="col-md-3 py-2">
                    <label> Loại trạm </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.StationTypeName">
                </div>
                <div class="col-md-12 py-2">
                    <label> Vị trí trạm </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.LocationName">
                </div>
                <div class="col-md-6 py-2">
                    <label>Quận/Huyện :</label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.DistrictName">
                </div>
                <div class="col-md-6 py-2">
                    <label>Xã/Phường :</label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.CommuneName">
                </div>
                <div class="col-12 col-md-12 mb-3">
                    <fieldset class="border p-2">
                        <legend class="float-none w-auto font-15 m-0 text-dark">Vị trí công trình</legend>
                        <div class="col-md-12 py-3 d-flex justify-content-between">
                            <div class="floating-label col-6 font-14 d-flex align-items-center">
                                <span>Lat:&nbsp;</span>
                                <input readonly type="number" id="lat-decimal" placeholder="0" class="floating-input w-100 mx-1" ng-model="license.Station.Lat">
                            </div>
                            <div class="floating-label col-6 font-14 d-flex align-items-center">
                                <span>Lng:&nbsp;</span>
                                <input readonly type="number" id="lng-decimal" placeholder="0" class="floating-input w-100" ng-model="license.Station.Lng">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="col-md-6 py-2">
                    <label> Năm bắt đầu đo </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.StartDate">
                </div>
                <div class="col-md-6 py-2">
                    <label> Năm kết thúc đo </label>
                    <input readonly type="text" class="floating-input w-100" placeholder=" " ng-model="license.Station.EndDate">
                </div>
            </div>
        </fieldset>
    </div>

    <div class="col-12">
        <fieldset class="col-12 border border-secondary px-2 mb-2 background-color bg-lightgray">
            <legend class="font-18 font-weight-bold text-primary" style="width: auto">GIẤY TỜ, TÀI LIỆU NỘP KÈM THEO (.pdf)</legend>
            <div class="mb-2 row mx-0 p-0 py-3">
                <div class="col-12 col-md-4">
                    <label class="font-13">Hồ sơ cấp phép</label>
                    <div class="tools d-flex justify-content-center" ng-if="license.LicenseFile">
                        <a href="javascript:void(0)" ng-click="openAsideFileLicense(license.TypeOfConstructionId, license.LicenseFile)">
                            <i class="fa-solid fa-file-pdf" title="Xem file PDF" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <label class="font-13">Đơn xin cấp phép</label>
                    <div class="tools d-flex justify-content-center" ng-if="license.LicenseRequestFile">
                        <a href="javascript:void(0)" ng-click="openAsideFileLicense(license.TypeOfConstructionId, license.LicenseRequestFile)">
                            <i class="fa-solid fa-file-pdf" title="Xem file PDF" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <label class="font-13">Hồ sơ pháp lý có liên quan</label>
                    <div class="tools d-flex justify-content-center" ng-if="license.RelatedDocumentFile">
                        <a href="javascript:void(0)" ng-click="openAsideFileLicense(license.TypeOfConstructionId, license.RelatedDocumentFile)">
                            <i class="fa-solid fa-file-pdf" title="Xem file PDF" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>

    <div class="pb-4 col-sm-12 d-flex justify-content-end">
        @if (_service.IsViewAction("/ho-so-giay-phep-hoat-dong", User.Identity.Name, "Save"))
        {
            <button type="button" class="btn btn-addnew mx-2 fw-bold font-14 d-flex align-items-center" ng-click="EDIT(license,'formCreateLicense', 'viewLicense')">
                CHỈNH SỬA &nbsp; <i class="fa fa-edit"></i>
            </button>
        }

        <button type="button" class="btn btn-cancel mx-2 fw-bold font-14 d-flex align-items-center" href="javascript:void(0)" ng-click="closeAside('viewLicense')">
            ĐÓNG &nbsp; <i class="fa fa-times-circle"></i>
        </button>
    </div>
</div>